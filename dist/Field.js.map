{"version":3,"sources":["../dist-esnext/Field.js"],"names":["positionIsValid","curry","field","p","x","length","y","nearPositions","pos","range","flatten","remove","map","i","j","validNearPos","filter","openPosition","openedPos","opened","markPosition","markedPos","updatePos","marked","isValidConfig","fieldConfig","totalPositions","width","height","bombs","allPositions","reduce","a","b","concat","countNearBombs","countedField","isBomb","nearBombs","getRandomPos","Math","floor","random","bombPos","config","getBombedField","last","getEmptyField","widthRange","heightRange","newPos","isValid","clone","getInitialField","Error","emptyField","bombedField","logField","indexColor","resetColor","firstLine","f","index","console","log","row","col","colIndex","line","numBombs","numBombsString"],"mappings":"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","file":"Field.js","sourcesContent":["import R from 'ramda';\r\n/**\r\n * Checks if field has position.\r\n */\r\nconst positionIsValid = R.curry((field, p) => {\r\n    return p.x >= 0 && p.x < field.length && p.y >= 0 && p.y < field[0].length;\r\n});\r\n/**\r\n * Receives a pos and return his near positions\r\n * args {IPositionArgs}\r\n * returns {IPositionArgs[]}\r\n */\r\nconst nearPositions = (pos) => {\r\n    const range = R.range(-1, 2);\r\n    /**\r\n     * Get a 3x3 position array with the position and all the near positions then remove the position itseft\r\n     */\r\n    return R.flatten(R.remove(4, 1, range.map(i => range.map(j => {\r\n        return { x: pos.x + i, y: pos.y + j };\r\n    }))));\r\n};\r\nconst validNearPos = R.curry((field, pos) => R.filter(positionIsValid(field), nearPositions(pos)));\r\nconst openPosition = (pos) => {\r\n    const openedPos = pos;\r\n    openedPos.opened = true;\r\n    return openedPos;\r\n};\r\nconst markPosition = (pos) => {\r\n    const markedPos = updatePos(pos);\r\n    if (markedPos.marked === 2)\r\n        markedPos.marked = 0;\r\n    else\r\n        markedPos.marked++;\r\n    return markedPos;\r\n};\r\nconst isValidConfig = (fieldConfig) => {\r\n    const totalPositions = fieldConfig.width * fieldConfig.height;\r\n    return totalPositions > fieldConfig.bombs ? true : false;\r\n};\r\nconst allPositions = (field) => field.reduce((a, b) => a.concat(b));\r\nconst countNearBombs = (field) => {\r\n    const countedField = field;\r\n    allPositions(field).map(pos => {\r\n        if (pos.isBomb)\r\n            validNearPos(field, pos).map(p => countedField[p.x][p.y].nearBombs++);\r\n    }); // TODO immutable\r\n    return countedField;\r\n};\r\n// TODO use ptz-math and help with any math method you need\r\nconst getRandomPos = (field, fieldConfig) => {\r\n    const width = Math.floor((fieldConfig.width - 1) * Math.random() + 1);\r\n    const height = Math.floor((fieldConfig.height - 1) * Math.random() + 1);\r\n    return field[width][height];\r\n};\r\nconst bombPos = (field, config) => {\r\n    const pos = getRandomPos(field, config);\r\n    if (pos.isBomb) {\r\n        return bombPos(field, config);\r\n    }\r\n    pos.isBomb = true;\r\n    return field;\r\n};\r\n/**\r\n * Populate new field with bombs\r\n */\r\nconst getBombedField = (field, config) => R.last(R.range(0, config.bombs).map(() => bombPos(field, config)));\r\nconst getEmptyField = (fieldConfig) => {\r\n    const widthRange = R.range(0, fieldConfig.width);\r\n    const heightRange = R.range(0, fieldConfig.height);\r\n    return widthRange.map(i => heightRange.map(j => newPos(i, j)));\r\n};\r\n/**\r\n * Get a new position\r\n */\r\nconst newPos = (x, y) => {\r\n    return {\r\n        x, y, isBomb: false, nearBombs: 0,\r\n        opened: false, marked: 0, isValid: true\r\n    };\r\n};\r\nconst updatePos = (pos) => R.clone(pos);\r\nconst getInitialField = (fieldConfig) => {\r\n    if (!isValidConfig(fieldConfig))\r\n        throw new Error('Invalid field configuration');\r\n    const emptyField = getEmptyField(fieldConfig);\r\n    const bombedField = getBombedField(emptyField, fieldConfig);\r\n    return countNearBombs(bombedField);\r\n};\r\n// TODO break in small functions\r\nfunction logField(field) {\r\n    const countedField = field;\r\n    const indexColor = '\\x1b[37m';\r\n    const resetColor = '\\x1b[0m';\r\n    let firstLine = '    ';\r\n    field.map((f, index) => firstLine += ' ' + (index + 1) + '  ');\r\n    console.log(indexColor + firstLine + resetColor);\r\n    let row;\r\n    field.map((col, colIndex) => {\r\n        var line = '|';\r\n        row = '   ';\r\n        col.map((pos, index) => {\r\n            if (index === 0 && colIndex === 0)\r\n                line = line;\r\n            if (index === 0)\r\n                line = ' ' + indexColor + (colIndex + 1) + resetColor + ' |';\r\n            if (countedField[pos.x][pos.y].opened) {\r\n                if (countedField[pos.x][pos.y].isBomb) {\r\n                    line += '\\x1b[31m * ' + resetColor;\r\n                    row += '---';\r\n                }\r\n                else {\r\n                    const numBombs = countedField[pos.x][pos.y].nearBombs;\r\n                    let numBombsString;\r\n                    switch (numBombs) {\r\n                        case 1:\r\n                            numBombsString = '\\x1b[34m' + numBombs;\r\n                            break;\r\n                        case 2:\r\n                            numBombsString = '\\x1b[32m' + numBombs;\r\n                            break;\r\n                        case 3:\r\n                            numBombsString = '\\x1b[33m' + numBombs;\r\n                            break;\r\n                        case 4:\r\n                            numBombsString = '\\x1b[35m' + numBombs;\r\n                            break;\r\n                        case 5:\r\n                            numBombsString = '\\x1b[36m' + numBombs;\r\n                            break;\r\n                        case 7:\r\n                            numBombsString = '\\x1b[31m' + numBombs;\r\n                            break;\r\n                        case 8:\r\n                            numBombsString = '\\x1b[37m' + numBombs;\r\n                            break;\r\n                        default:\r\n                            numBombsString = '\\x1b[37m' + numBombs;\r\n                    }\r\n                    line += ' ' + numBombsString + resetColor + ' ';\r\n                    row += '---';\r\n                }\r\n            }\r\n            else {\r\n                line += '   ';\r\n                row += '---';\r\n            }\r\n            line += '|';\r\n            row += '-';\r\n        });\r\n        console.log(row);\r\n        console.log(line);\r\n    });\r\n    console.log(row + '\\n');\r\n}\r\nexport { allPositions, getInitialField, getEmptyField, getBombedField, countNearBombs, logField, markPosition, nearPositions, newPos, openPosition, positionIsValid, validNearPos, updatePos };\r\n//# sourceMappingURL=Field.js.map"]}